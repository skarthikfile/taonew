define("taoRevision/controller/routes",[],function(){return{History:{actions:{index:"controller/history/index"}}}}),define("tpl!taoRevision/controller/history/line",["handlebars"],function(hb){return hb.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,helper,options,buffer="",functionType="function",escapeExpression=this.escapeExpression,helperMissing=helpers.helperMissing;return buffer+='<tr>\n    <td class="numeric">',(helper=helpers.id)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.id,stack1=typeof helper===functionType?helper.call(depth0,{
hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'</td>\n    <td class="date">',(helper=helpers.modified)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.modified,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'</td>\n    <td class="user">',(helper=helpers.author)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.author,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),(stack1||0===stack1)&&(buffer+=stack1),buffer+='</td>\n    <td class="message">',(helper=helpers.message)?stack1=helper.call(depth0,{hash:{},
data:data}):(helper=depth0&&depth0.message,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'</td>\n    <td class="actions">\n        <button class="btn-info small restore_revision" data-revision="',(helper=helpers.id)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.id,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'">\n            <span class="icon-undo"></span>\n            '+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Restore",options):helperMissing.call(depth0,"__","Restore",options)))+"\n        </button>\n    </td>\n</tr>\n";
})}),define("taoRevision/controller/history/index",["jquery","i18n","tpl!taoRevision/controller/history/line","helpers","ui/feedback","select2","tooltipster"],function($,__,lineTpl,helpers,feedback){"use strict";var _restoreRevision=function(element){var $table=$("#revisions-table"),body=$table.find("tbody")[0],$this=$(element),revision=$this.data("revision"),id=$("#resource_id").val(),message=prompt("Please enter a message",__("Restored version %s",revision));"undefined"!=typeof revision&&"undefined"!=typeof message&&null!=message&&""!==revision&&""!==message&&$.post(helpers._url("restoreRevision","History","taoRevision"),{id:id,revisionId:revision,message:message
}).done(function(res){res&&res.success?(feedback().success(__("Resource restored")),$(body).append(lineTpl(res)),$(".tree").trigger("refresh.taotree")):feedback().error(__("Something went wrong..."))})},mainCtrl={start:function(){var $container=$(".revision-container"),$form=$("form",$container),$submiter=$(":submit",$form),$table=$("#revisions-table"),body=$table.find("tbody")[0];$form.on("submit",function(e){e.preventDefault(),e.stopImmediatePropagation()}),$submiter.on("click",function(e){e.preventDefault();var $message=$("#message",$form);""!==$message.val()?($submiter.addClass("disabled"),$.post($form.attr("action"),$form.serialize()).done(function(res){
res&&res.success?(feedback().success(res.commitMessage),$(body).append(lineTpl(res))):feedback().error(__("Something went wrong..."))}).complete(function(){$submiter.removeClass("disabled"),$message.val("")})):feedback().error(__("Please give a message to your commit"))}),$table.on("click",".restore_revision",function(event){event.preventDefault(),_restoreRevision(this)})}};return mainCtrl});
//# sourceMappingURL=controllers.min.js.map